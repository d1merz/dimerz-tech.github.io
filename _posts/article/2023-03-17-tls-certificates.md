---
layout: post
title: "PKI, сертификаты и все все все..."
date: 2023-03-17 20:28:39 +0300
categories: article
---

Цель написания данной статьи - наконец раз и навсегда агрегировать и рассмотреть все бытовые случаи использования сертификатов, ключей, электронных подписей
а самое главное - понять, как эти технологии взаимодействуют друг с другом и каждый день предоставляют нам возможность безопасно пользоваться интернетом.

Наверное каждый, кто сталкивался и пытался разобраться с такими протоколами как `https`, `tls/ssl`, `ssh`... видел на просторах интернета замечательную историю,
как [Боб и Алиса](https://ru.wikipedia.org/wiki/Алиса_и_Боб) хотят обменяться сообщениями по закрытому каналу. Поэтому повторять уже сказанное десятки раз я не буду,
мой манускрипт больше про те аспекты, которые почему-то обычно остаются за кадром.

# Виды шифрований

Итак, мы знаем, что Бобу необходимо зашифровать сообщение Алисе, чтобы [злоумышленник](https://ru.wikipedia.org/wiki/Атака_посредника) при перехвате сообщения ничего в нем не понял.
Существует 2 вида шифрований:

<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;}
.tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
  overflow:hidden;padding:10px 5px;word-break:normal;}
.tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
  font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
.tg .tg-d52n{background-color:#32cb00;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-0lax{text-align:left;vertical-align:top}
.tg .tg-ut5e{background-color:#c0c0c0;border-color:inherit;color:#333333;text-align:center;vertical-align:top}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
</style>
<table class="tg">
<thead>
  <tr>
    <th class="tg-0lax"></th>
    <th class="tg-ut5e">Симметричное</th>
    <th class="tg-ut5e">Асимметричное</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td class="tg-0lax">Скорость, нагрузка на CPU</td>
    <td class="tg-d52n">Быстро (короткий ключ)</td>
    <td class="tg-0pky">Медленно (длинный ключ)</td>
  </tr>
  <tr>
    <td class="tg-0lax"> Секьюрность</td>
    <td class="tg-0pky">Небезопасно (нужно обмениваться общим ключом)</td>
    <td class="tg-d52n">Безопасно (обмен происходит только открытым ключом)</td>
  </tr>
  <tr>
    <td class="tg-0lax">Алгоритмы</td>
    <td class="tg-0lax">DES, RC4, 3DES, AES, ChaCha20</td>
    <td class="tg-0lax">DSA, RSA, Diffie-Helman, ECDSA, ECDH</td>
  </tr>
</tbody>
</table>

Как видно, кажется, что универсального решения нет, но на самом деле есть. И называется оно гибридным шифрованием. Это когда мы генерируем общий (быстрый) ключ, а передаем его секьюрно
с помощью закрытого и открытого ключа. Получается, что общий ключ не подвержен перехвату (грубо), а последующее шифрование им данных происходит быстро.

На самом деле, я написал в скобках грубо, так как всем известна проблема отсутствия аутентификации при таком подходе. Такое может произойти, если злоумышленник узнает о планах Боба и Алисы
пообщаться и напишет Алисе первым, представившись Бобом. Тогда Алиса передаст ему свой открытый ключ, и у них начнется обмен сообщениями :hand_over_mouth:.
Для этого Алиса должна как то понимать, что пишет ей именно Боб. Для этого была придумана электронная цифровая подпись.

## ЭЦП

Электронная подпись появилась благодаря внезапному свойству ассиметричных ключей быть симметричными :clown_face:. То есть то, <ins> что шифрует открытый ключ, может быть расшифровано закрытым, 
а то что шифрует закрытый ключ может быть расшифровано открытым </ins>. 
